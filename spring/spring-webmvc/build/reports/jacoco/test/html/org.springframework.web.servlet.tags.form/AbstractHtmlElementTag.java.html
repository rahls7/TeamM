<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AbstractHtmlElementTag.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">spring-webmvc</a> &gt; <a href="index.source.html" class="el_package">org.springframework.web.servlet.tags.form</a> &gt; <span class="el_source">AbstractHtmlElementTag.java</span></div><h1>AbstractHtmlElementTag.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2002-2018 the original author or authors.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.springframework.web.servlet.tags.form;

import java.util.HashMap;
import java.util.Map;
import javax.servlet.jsp.JspException;
import javax.servlet.jsp.tagext.DynamicAttributes;

import org.springframework.lang.Nullable;
import org.springframework.util.CollectionUtils;
import org.springframework.util.ObjectUtils;
import org.springframework.util.StringUtils;

/**
 * Base class for databinding-aware JSP tags that render HTML element. Provides
 * a set of properties corresponding to the set of HTML attributes that are common
 * across elements.
 *
 * &lt;p&gt;Additionally, this base class allows for rendering non-standard attributes
 * as part of the tag's output.  These attributes are accessible to subclasses if
 * needed via the {@link AbstractHtmlElementTag#getDynamicAttributes() dynamicAttributes}
 * map.
 *
 * @author Rob Harrop
 * @author Jeremy Grelle
 * @author Rossen Stoyanchev
 * @since 2.0
 */
@SuppressWarnings(&quot;serial&quot;)
<span class="fc" id="L45">public abstract class AbstractHtmlElementTag extends AbstractDataBoundFormElementTag implements DynamicAttributes {</span>

	public static final String CLASS_ATTRIBUTE = &quot;class&quot;;

	public static final String STYLE_ATTRIBUTE = &quot;style&quot;;

	public static final String LANG_ATTRIBUTE = &quot;lang&quot;;

	public static final String TITLE_ATTRIBUTE = &quot;title&quot;;

	public static final String DIR_ATTRIBUTE = &quot;dir&quot;;

	public static final String TABINDEX_ATTRIBUTE = &quot;tabindex&quot;;

	public static final String ONCLICK_ATTRIBUTE = &quot;onclick&quot;;

	public static final String ONDBLCLICK_ATTRIBUTE = &quot;ondblclick&quot;;

	public static final String ONMOUSEDOWN_ATTRIBUTE = &quot;onmousedown&quot;;

	public static final String ONMOUSEUP_ATTRIBUTE = &quot;onmouseup&quot;;

	public static final String ONMOUSEOVER_ATTRIBUTE = &quot;onmouseover&quot;;

	public static final String ONMOUSEMOVE_ATTRIBUTE = &quot;onmousemove&quot;;

	public static final String ONMOUSEOUT_ATTRIBUTE = &quot;onmouseout&quot;;

	public static final String ONKEYPRESS_ATTRIBUTE = &quot;onkeypress&quot;;

	public static final String ONKEYUP_ATTRIBUTE = &quot;onkeyup&quot;;

	public static final String ONKEYDOWN_ATTRIBUTE = &quot;onkeydown&quot;;


	@Nullable
	private String cssClass;

	@Nullable
	private String cssErrorClass;

	@Nullable
	private String cssStyle;

	@Nullable
	private String lang;

	@Nullable
	private String title;

	@Nullable
	private String dir;

	@Nullable
	private String tabindex;

	@Nullable
	private String onclick;

	@Nullable
	private String ondblclick;

	@Nullable
	private String onmousedown;

	@Nullable
	private String onmouseup;

	@Nullable
	private String onmouseover;

	@Nullable
	private String onmousemove;

	@Nullable
	private String onmouseout;

	@Nullable
	private String onkeypress;

	@Nullable
	private String onkeyup;

	@Nullable
	private String onkeydown;

	@Nullable
	private Map&lt;String, Object&gt; dynamicAttributes;


	/**
	 * Set the value of the '{@code class}' attribute.
	 * May be a runtime expression.
	 */
	public void setCssClass(String cssClass) {
<span class="fc" id="L140">		this.cssClass = cssClass;</span>
<span class="fc" id="L141">	}</span>

	/**
	 * Get the value of the '{@code class}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getCssClass() {
<span class="fc" id="L149">		return this.cssClass;</span>
	}

	/**
	 * The CSS class to use when the field bound to a particular tag has errors.
	 * May be a runtime expression.
	 */
	public void setCssErrorClass(String cssErrorClass) {
<span class="fc" id="L157">		this.cssErrorClass = cssErrorClass;</span>
<span class="fc" id="L158">	}</span>

	/**
	 * The CSS class to use when the field bound to a particular tag has errors.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getCssErrorClass() {
<span class="fc" id="L166">		return this.cssErrorClass;</span>
	}

	/**
	 * Set the value of the '{@code style}' attribute.
	 * May be a runtime expression.
	 */
	public void setCssStyle(String cssStyle) {
<span class="fc" id="L174">		this.cssStyle = cssStyle;</span>
<span class="fc" id="L175">	}</span>

	/**
	 * Get the value of the '{@code style}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getCssStyle() {
<span class="fc" id="L183">		return this.cssStyle;</span>
	}

	/**
	 * Set the value of the '{@code lang}' attribute.
	 * May be a runtime expression.
	 */
	public void setLang(String lang) {
<span class="fc" id="L191">		this.lang = lang;</span>
<span class="fc" id="L192">	}</span>

	/**
	 * Get the value of the '{@code lang}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getLang() {
<span class="fc" id="L200">		return this.lang;</span>
	}

	/**
	 * Set the value of the '{@code title}' attribute.
	 * May be a runtime expression.
	 */
	public void setTitle(String title) {
<span class="fc" id="L208">		this.title = title;</span>
<span class="fc" id="L209">	}</span>

	/**
	 * Get the value of the '{@code title}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getTitle() {
<span class="fc" id="L217">		return this.title;</span>
	}

	/**
	 * Set the value of the '{@code dir}' attribute.
	 * May be a runtime expression.
	 */
	public void setDir(String dir) {
<span class="fc" id="L225">		this.dir = dir;</span>
<span class="fc" id="L226">	}</span>

	/**
	 * Get the value of the '{@code dir}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getDir() {
<span class="fc" id="L234">		return this.dir;</span>
	}

	/**
	 * Set the value of the '{@code tabindex}' attribute.
	 * May be a runtime expression.
	 */
	public void setTabindex(String tabindex) {
<span class="fc" id="L242">		this.tabindex = tabindex;</span>
<span class="fc" id="L243">	}</span>

	/**
	 * Get the value of the '{@code tabindex}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getTabindex() {
<span class="fc" id="L251">		return this.tabindex;</span>
	}

	/**
	 * Set the value of the '{@code onclick}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnclick(String onclick) {
<span class="fc" id="L259">		this.onclick = onclick;</span>
<span class="fc" id="L260">	}</span>

	/**
	 * Get the value of the '{@code onclick}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnclick() {
<span class="fc" id="L268">		return this.onclick;</span>
	}

	/**
	 * Set the value of the '{@code ondblclick}' attribute.
	 * May be a runtime expression.
	 */
	public void setOndblclick(String ondblclick) {
<span class="fc" id="L276">		this.ondblclick = ondblclick;</span>
<span class="fc" id="L277">	}</span>

	/**
	 * Get the value of the '{@code ondblclick}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOndblclick() {
<span class="fc" id="L285">		return this.ondblclick;</span>
	}

	/**
	 * Set the value of the '{@code onmousedown}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnmousedown(String onmousedown) {
<span class="fc" id="L293">		this.onmousedown = onmousedown;</span>
<span class="fc" id="L294">	}</span>

	/**
	 * Get the value of the '{@code onmousedown}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnmousedown() {
<span class="fc" id="L302">		return this.onmousedown;</span>
	}

	/**
	 * Set the value of the '{@code onmouseup}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnmouseup(String onmouseup) {
<span class="fc" id="L310">		this.onmouseup = onmouseup;</span>
<span class="fc" id="L311">	}</span>

	/**
	 * Get the value of the '{@code onmouseup}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnmouseup() {
<span class="fc" id="L319">		return this.onmouseup;</span>
	}

	/**
	 * Set the value of the '{@code onmouseover}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnmouseover(String onmouseover) {
<span class="fc" id="L327">		this.onmouseover = onmouseover;</span>
<span class="fc" id="L328">	}</span>

	/**
	 * Get the value of the '{@code onmouseover}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnmouseover() {
<span class="fc" id="L336">		return this.onmouseover;</span>
	}

	/**
	 * Set the value of the '{@code onmousemove}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnmousemove(String onmousemove) {
<span class="fc" id="L344">		this.onmousemove = onmousemove;</span>
<span class="fc" id="L345">	}</span>

	/**
	 * Get the value of the '{@code onmousemove}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnmousemove() {
<span class="fc" id="L353">		return this.onmousemove;</span>
	}

	/**
	 * Set the value of the '{@code onmouseout}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnmouseout(String onmouseout) {
<span class="fc" id="L361">		this.onmouseout = onmouseout;</span>
<span class="fc" id="L362">	}</span>
	/**
	 * Get the value of the '{@code onmouseout}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnmouseout() {
<span class="fc" id="L369">		return this.onmouseout;</span>
	}

	/**
	 * Set the value of the '{@code onkeypress}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnkeypress(String onkeypress) {
<span class="fc" id="L377">		this.onkeypress = onkeypress;</span>
<span class="fc" id="L378">	}</span>

	/**
	 * Get the value of the '{@code onkeypress}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnkeypress() {
<span class="fc" id="L386">		return this.onkeypress;</span>
	}

	/**
	 * Set the value of the '{@code onkeyup}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnkeyup(String onkeyup) {
<span class="fc" id="L394">		this.onkeyup = onkeyup;</span>
<span class="fc" id="L395">	}</span>

	/**
	 * Get the value of the '{@code onkeyup}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnkeyup() {
<span class="fc" id="L403">		return this.onkeyup;</span>
	}

	/**
	 * Set the value of the '{@code onkeydown}' attribute.
	 * May be a runtime expression.
	 */
	public void setOnkeydown(String onkeydown) {
<span class="fc" id="L411">		this.onkeydown = onkeydown;</span>
<span class="fc" id="L412">	}</span>

	/**
	 * Get the value of the '{@code onkeydown}' attribute.
	 * May be a runtime expression.
	 */
	@Nullable
	protected String getOnkeydown() {
<span class="fc" id="L420">		return this.onkeydown;</span>
	}

	/**
	 * Get the map of dynamic attributes.
	 */
	@Nullable
	protected Map&lt;String, Object&gt; getDynamicAttributes() {
<span class="fc" id="L428">		return this.dynamicAttributes;</span>
	}

	/**
	 * {@inheritDoc}
	 */
	@Override
	public void setDynamicAttribute(String uri, String localName, Object value) throws JspException {
<span class="fc bfc" id="L436" title="All 2 branches covered.">		if (this.dynamicAttributes == null) {</span>
<span class="fc" id="L437">			this.dynamicAttributes = new HashMap&lt;&gt;();</span>
		}
<span class="fc bfc" id="L439" title="All 2 branches covered.">		if (!isValidDynamicAttribute(localName, value)) {</span>
<span class="fc" id="L440">			throw new IllegalArgumentException(</span>
					&quot;Attribute &quot; + localName + &quot;=\&quot;&quot; + value + &quot;\&quot; is not allowed&quot;);
		}
<span class="fc" id="L443">		this.dynamicAttributes.put(localName, value);</span>
<span class="fc" id="L444">	}</span>

	/**
	 * Whether the given name-value pair is a valid dynamic attribute.
	 */
	protected boolean isValidDynamicAttribute(String localName, Object value) {
<span class="fc" id="L450">		return true;</span>
	}

	/**
	 * Writes the default attributes configured via this base class to the supplied {@link TagWriter}.
	 * Subclasses should call this when they want the base attribute set to be written to the output.
	 */
	@Override
	protected void writeDefaultAttributes(TagWriter tagWriter) throws JspException {
<span class="fc" id="L459">		super.writeDefaultAttributes(tagWriter);</span>
<span class="fc" id="L460">		writeOptionalAttributes(tagWriter);</span>
<span class="fc" id="L461">	}</span>

	/**
	 * Writes the optional attributes configured via this base class to the supplied {@link TagWriter}.
	 * The set of optional attributes that will be rendered includes any non-standard dynamic attributes.
	 * Called by {@link #writeDefaultAttributes(TagWriter)}.
	 */
	protected void writeOptionalAttributes(TagWriter tagWriter) throws JspException {
<span class="fc" id="L469">		tagWriter.writeOptionalAttributeValue(CLASS_ATTRIBUTE, resolveCssClass());</span>
<span class="fc" id="L470">		tagWriter.writeOptionalAttributeValue(STYLE_ATTRIBUTE,</span>
<span class="fc" id="L471">				ObjectUtils.getDisplayString(evaluate(&quot;cssStyle&quot;, getCssStyle())));</span>
<span class="fc" id="L472">		writeOptionalAttribute(tagWriter, LANG_ATTRIBUTE, getLang());</span>
<span class="fc" id="L473">		writeOptionalAttribute(tagWriter, TITLE_ATTRIBUTE, getTitle());</span>
<span class="fc" id="L474">		writeOptionalAttribute(tagWriter, DIR_ATTRIBUTE, getDir());</span>
<span class="fc" id="L475">		writeOptionalAttribute(tagWriter, TABINDEX_ATTRIBUTE, getTabindex());</span>
<span class="fc" id="L476">		writeOptionalAttribute(tagWriter, ONCLICK_ATTRIBUTE, getOnclick());</span>
<span class="fc" id="L477">		writeOptionalAttribute(tagWriter, ONDBLCLICK_ATTRIBUTE, getOndblclick());</span>
<span class="fc" id="L478">		writeOptionalAttribute(tagWriter, ONMOUSEDOWN_ATTRIBUTE, getOnmousedown());</span>
<span class="fc" id="L479">		writeOptionalAttribute(tagWriter, ONMOUSEUP_ATTRIBUTE, getOnmouseup());</span>
<span class="fc" id="L480">		writeOptionalAttribute(tagWriter, ONMOUSEOVER_ATTRIBUTE, getOnmouseover());</span>
<span class="fc" id="L481">		writeOptionalAttribute(tagWriter, ONMOUSEMOVE_ATTRIBUTE, getOnmousemove());</span>
<span class="fc" id="L482">		writeOptionalAttribute(tagWriter, ONMOUSEOUT_ATTRIBUTE, getOnmouseout());</span>
<span class="fc" id="L483">		writeOptionalAttribute(tagWriter, ONKEYPRESS_ATTRIBUTE, getOnkeypress());</span>
<span class="fc" id="L484">		writeOptionalAttribute(tagWriter, ONKEYUP_ATTRIBUTE, getOnkeyup());</span>
<span class="fc" id="L485">		writeOptionalAttribute(tagWriter, ONKEYDOWN_ATTRIBUTE, getOnkeydown());</span>

<span class="fc bfc" id="L487" title="All 2 branches covered.">		if (!CollectionUtils.isEmpty(this.dynamicAttributes)) {</span>
<span class="fc bfc" id="L488" title="All 2 branches covered.">			for (String attr : this.dynamicAttributes.keySet()) {</span>
<span class="fc" id="L489">				tagWriter.writeOptionalAttributeValue(attr, getDisplayString(this.dynamicAttributes.get(attr)));</span>
<span class="fc" id="L490">			}</span>
		}
<span class="fc" id="L492">	}</span>

	/**
	 * Gets the appropriate CSS class to use based on the state of the current
	 * {@link org.springframework.web.servlet.support.BindStatus} object.
	 */
	protected String resolveCssClass() throws JspException {
<span class="fc bfc" id="L499" title="All 4 branches covered.">		if (getBindStatus().isError() &amp;&amp; StringUtils.hasText(getCssErrorClass())) {</span>
<span class="fc" id="L500">			return ObjectUtils.getDisplayString(evaluate(&quot;cssErrorClass&quot;, getCssErrorClass()));</span>
		}
		else {
<span class="fc" id="L503">			return ObjectUtils.getDisplayString(evaluate(&quot;cssClass&quot;, getCssClass()));</span>
		}
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>