<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Apache Commons Math</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.math4.stat.inference</a> &gt; <span class="el_source">TTest.java</span></div><h1>TTest.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.commons.math4.stat.inference;

import org.apache.commons.statistics.distribution.TDistribution;
import org.apache.commons.math4.exception.DimensionMismatchException;
import org.apache.commons.math4.exception.MathIllegalArgumentException;
import org.apache.commons.math4.exception.MaxCountExceededException;
import org.apache.commons.math4.exception.NoDataException;
import org.apache.commons.math4.exception.NotStrictlyPositiveException;
import org.apache.commons.math4.exception.NullArgumentException;
import org.apache.commons.math4.exception.NumberIsTooSmallException;
import org.apache.commons.math4.exception.OutOfRangeException;
import org.apache.commons.math4.exception.util.LocalizedFormats;
import org.apache.commons.math4.stat.StatUtils;
import org.apache.commons.math4.stat.descriptive.StatisticalSummary;
import org.apache.commons.math4.util.FastMath;

/**
 * An implementation for Student's t-tests.
 * &lt;p&gt;
 * Tests can be:&lt;ul&gt;
 * &lt;li&gt;One-sample or two-sample&lt;/li&gt;
 * &lt;li&gt;One-sided or two-sided&lt;/li&gt;
 * &lt;li&gt;Paired or unpaired (for two-sample tests)&lt;/li&gt;
 * &lt;li&gt;Homoscedastic (equal variance assumption) or heteroscedastic
 * (for two sample tests)&lt;/li&gt;
 * &lt;li&gt;Fixed significance level (boolean-valued) or returning p-values.
 * &lt;/li&gt;&lt;/ul&gt;
 * &lt;p&gt;
 * Test statistics are available for all tests.  Methods including &quot;Test&quot; in
 * in their names perform tests, all other methods return t-statistics.  Among
 * the &quot;Test&quot; methods, &lt;code&gt;double-&lt;/code&gt;valued methods return p-values;
 * &lt;code&gt;boolean-&lt;/code&gt;valued methods perform fixed significance level tests.
 * Significance levels are always specified as numbers between 0 and 0.5
 * (e.g. tests at the 95% level  use &lt;code&gt;alpha=0.05&lt;/code&gt;).&lt;/p&gt;
 * &lt;p&gt;
 * Input to tests can be either &lt;code&gt;double[]&lt;/code&gt; arrays or
 * {@link StatisticalSummary} instances.&lt;/p&gt;&lt;p&gt;
 * Uses commons-math {@link org.apache.commons.statistics.distribution.TDistribution}
 * implementation to estimate exact p-values.&lt;/p&gt;
 *
 */
<span class="fc" id="L58">public class TTest {</span>
    /**
     * Computes a paired, 2-sample t-statistic based on the data in the input
     * arrays.  The t-statistic returned is equivalent to what would be returned by
     * computing the one-sample t-statistic {@link #t(double, double[])}, with
     * &lt;code&gt;mu = 0&lt;/code&gt; and the sample array consisting of the (signed)
     * differences between corresponding entries in &lt;code&gt;sample1&lt;/code&gt; and
     * &lt;code&gt;sample2.&lt;/code&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The input arrays must have the same length and their common length
     * must be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @return t statistic
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NoDataException if the arrays are empty
     * @throws DimensionMismatchException if the length of the arrays is not equal
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     */
    public double pairedT(final double[] sample1, final double[] sample2)
        throws NullArgumentException, NoDataException,
        DimensionMismatchException, NumberIsTooSmallException {

<span class="fc" id="L84">        checkSampleData(sample1);</span>
<span class="fc" id="L85">        checkSampleData(sample2);</span>
<span class="fc" id="L86">        double meanDifference = StatUtils.meanDifference(sample1, sample2);</span>
<span class="fc" id="L87">        return t(meanDifference, 0,</span>
<span class="fc" id="L88">                 StatUtils.varianceDifference(sample1, sample2, meanDifference),</span>
                 sample1.length);

    }

    /**
     * Returns the &lt;i&gt;observed significance level&lt;/i&gt;, or
     * &lt;i&gt; p-value&lt;/i&gt;, associated with a paired, two-sample, two-tailed t-test
     * based on the data in the input arrays.
     * &lt;p&gt;
     * The number returned is the smallest significance level
     * at which one can reject the null hypothesis that the mean of the paired
     * differences is 0 in favor of the two-sided alternative that the mean paired
     * difference is not equal to 0. For a one-sided test, divide the returned
     * value by 2.&lt;/p&gt;
     * &lt;p&gt;
     * This test is equivalent to a one-sample t-test computed using
     * {@link #tTest(double, double[])} with &lt;code&gt;mu = 0&lt;/code&gt; and the sample
     * array consisting of the signed differences between corresponding elements of
     * &lt;code&gt;sample1&lt;/code&gt; and &lt;code&gt;sample2.&lt;/code&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the p-value depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The input array lengths must be the same and their common length must
     * be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @return p-value for t-test
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NoDataException if the arrays are empty
     * @throws DimensionMismatchException if the length of the arrays is not equal
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public double pairedTTest(final double[] sample1, final double[] sample2)
        throws NullArgumentException, NoDataException, DimensionMismatchException,
        NumberIsTooSmallException, MaxCountExceededException {

<span class="fc" id="L133">        double meanDifference = StatUtils.meanDifference(sample1, sample2);</span>
<span class="fc" id="L134">        return tTest(meanDifference, 0,</span>
<span class="fc" id="L135">                StatUtils.varianceDifference(sample1, sample2, meanDifference),</span>
                sample1.length);

    }

    /**
     * Performs a paired t-test evaluating the null hypothesis that the
     * mean of the paired differences between &lt;code&gt;sample1&lt;/code&gt; and
     * &lt;code&gt;sample2&lt;/code&gt; is 0 in favor of the two-sided alternative that the
     * mean paired difference is not equal to 0, with significance level
     * &lt;code&gt;alpha&lt;/code&gt;.
     * &lt;p&gt;
     * Returns &lt;code&gt;true&lt;/code&gt; iff the null hypothesis can be rejected with
     * confidence &lt;code&gt;1 - alpha&lt;/code&gt;.  To perform a 1-sided test, use
     * &lt;code&gt;alpha * 2&lt;/code&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the test depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The input array lengths must be the same and their common length
     * must be at least 2.
     * &lt;/li&gt;
     * &lt;li&gt; &lt;code&gt; 0 &amp;lt; alpha &amp;lt; 0.5 &lt;/code&gt;
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @param alpha significance level of the test
     * @return true if the null hypothesis can be rejected with
     * confidence 1 - alpha
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NoDataException if the arrays are empty
     * @throws DimensionMismatchException if the length of the arrays is not equal
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     * @throws OutOfRangeException if &lt;code&gt;alpha&lt;/code&gt; is not in the range (0, 0.5]
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public boolean pairedTTest(final double[] sample1, final double[] sample2,
                               final double alpha)
        throws NullArgumentException, NoDataException, DimensionMismatchException,
        NumberIsTooSmallException, OutOfRangeException, MaxCountExceededException {

<span class="fc" id="L181">        checkSignificanceLevel(alpha);</span>
<span class="fc bfc" id="L182" title="All 2 branches covered.">        return pairedTTest(sample1, sample2) &lt; alpha;</span>

    }

    /**
     * Computes a &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/prc/section2/prc22.htm#formula&quot;&gt;
     * t statistic &lt;/a&gt; given observed values and a comparison constant.
     * &lt;p&gt;
     * This statistic can be used to perform a one sample t-test for the mean.
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array length must be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param mu comparison constant
     * @param observed array of values
     * @return t statistic
     * @throws NullArgumentException if &lt;code&gt;observed&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of &lt;code&gt;observed&lt;/code&gt; is &amp;lt; 2
     */
    public double t(final double mu, final double[] observed)
        throws NullArgumentException, NumberIsTooSmallException {

<span class="fc" id="L205">        checkSampleData(observed);</span>
        // No try-catch or advertised exception because args have just been checked
<span class="fc" id="L207">        return t(StatUtils.mean(observed), mu, StatUtils.variance(observed),</span>
                observed.length);

    }

    /**
     * Computes a &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/prc/section2/prc22.htm#formula&quot;&gt;
     * t statistic &lt;/a&gt; to use in comparing the mean of the dataset described by
     * &lt;code&gt;sampleStats&lt;/code&gt; to &lt;code&gt;mu&lt;/code&gt;.
     * &lt;p&gt;
     * This statistic can be used to perform a one sample t-test for the mean.
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;&lt;code&gt;observed.getN() &amp;ge; 2&lt;/code&gt;.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param mu comparison constant
     * @param sampleStats DescriptiveStatistics holding sample summary statitstics
     * @return t statistic
     * @throws NullArgumentException if &lt;code&gt;sampleStats&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the number of samples is &amp;lt; 2
     */
    public double t(final double mu, final StatisticalSummary sampleStats)
        throws NullArgumentException, NumberIsTooSmallException {

<span class="fc" id="L232">        checkSampleData(sampleStats);</span>
<span class="fc" id="L233">        return t(sampleStats.getMean(), mu, sampleStats.getVariance(),</span>
<span class="fc" id="L234">                 sampleStats.getN());</span>

    }

    /**
     * Computes a 2-sample t statistic,  under the hypothesis of equal
     * subpopulation variances.  To compute a t-statistic without the
     * equal variances hypothesis, use {@link #t(double[], double[])}.
     * &lt;p&gt;
     * This statistic can be used to perform a (homoscedastic) two-sample
     * t-test to compare sample means.&lt;/p&gt;
     * &lt;p&gt;
     * The t-statistic is&lt;/p&gt;
     * &lt;p&gt;
     * &amp;nbsp;&amp;nbsp;&lt;code&gt;  t = (m1 - m2) / (sqrt(1/n1 +1/n2) sqrt(var))&lt;/code&gt;
     * &lt;/p&gt;&lt;p&gt;
     * where &lt;strong&gt;&lt;code&gt;n1&lt;/code&gt;&lt;/strong&gt; is the size of first sample;
     * &lt;strong&gt;&lt;code&gt; n2&lt;/code&gt;&lt;/strong&gt; is the size of second sample;
     * &lt;strong&gt;&lt;code&gt; m1&lt;/code&gt;&lt;/strong&gt; is the mean of first sample;
     * &lt;strong&gt;&lt;code&gt; m2&lt;/code&gt;&lt;/strong&gt; is the mean of second sample
     * and &lt;strong&gt;&lt;code&gt;var&lt;/code&gt;&lt;/strong&gt; is the pooled variance estimate:
     * &lt;/p&gt;&lt;p&gt;
     * &lt;code&gt;var = sqrt(((n1 - 1)var1 + (n2 - 1)var2) / ((n1-1) + (n2-1)))&lt;/code&gt;
     * &lt;/p&gt;&lt;p&gt;
     * with &lt;strong&gt;&lt;code&gt;var1&lt;/code&gt;&lt;/strong&gt; the variance of the first sample and
     * &lt;strong&gt;&lt;code&gt;var2&lt;/code&gt;&lt;/strong&gt; the variance of the second sample.
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array lengths must both be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @return t statistic
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     */
    public double homoscedasticT(final double[] sample1, final double[] sample2)
        throws NullArgumentException, NumberIsTooSmallException {

<span class="fc" id="L274">        checkSampleData(sample1);</span>
<span class="fc" id="L275">        checkSampleData(sample2);</span>
        // No try-catch or advertised exception because args have just been checked
<span class="fc" id="L277">        return homoscedasticT(StatUtils.mean(sample1), StatUtils.mean(sample2),</span>
<span class="fc" id="L278">                              StatUtils.variance(sample1), StatUtils.variance(sample2),</span>
                              sample1.length, sample2.length);

    }

    /**
     * Computes a 2-sample t statistic, without the hypothesis of equal
     * subpopulation variances.  To compute a t-statistic assuming equal
     * variances, use {@link #homoscedasticT(double[], double[])}.
     * &lt;p&gt;
     * This statistic can be used to perform a two-sample t-test to compare
     * sample means.&lt;/p&gt;
     * &lt;p&gt;
     * The t-statistic is&lt;/p&gt;
     * &lt;p&gt;
     * &amp;nbsp;&amp;nbsp; &lt;code&gt;  t = (m1 - m2) / sqrt(var1/n1 + var2/n2)&lt;/code&gt;
     * &lt;/p&gt;&lt;p&gt;
     *  where &lt;strong&gt;&lt;code&gt;n1&lt;/code&gt;&lt;/strong&gt; is the size of the first sample
     * &lt;strong&gt;&lt;code&gt; n2&lt;/code&gt;&lt;/strong&gt; is the size of the second sample;
     * &lt;strong&gt;&lt;code&gt; m1&lt;/code&gt;&lt;/strong&gt; is the mean of the first sample;
     * &lt;strong&gt;&lt;code&gt; m2&lt;/code&gt;&lt;/strong&gt; is the mean of the second sample;
     * &lt;strong&gt;&lt;code&gt; var1&lt;/code&gt;&lt;/strong&gt; is the variance of the first sample;
     * &lt;strong&gt;&lt;code&gt; var2&lt;/code&gt;&lt;/strong&gt; is the variance of the second sample;
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array lengths must both be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @return t statistic
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     */
    public double t(final double[] sample1, final double[] sample2)
        throws NullArgumentException, NumberIsTooSmallException {

<span class="fc" id="L315">        checkSampleData(sample1);</span>
<span class="fc" id="L316">        checkSampleData(sample2);</span>
        // No try-catch or advertised exception because args have just been checked
<span class="fc" id="L318">        return t(StatUtils.mean(sample1), StatUtils.mean(sample2),</span>
<span class="fc" id="L319">                 StatUtils.variance(sample1), StatUtils.variance(sample2),</span>
                 sample1.length, sample2.length);

    }

    /**
     * Computes a 2-sample t statistic, comparing the means of the datasets
     * described by two {@link StatisticalSummary} instances, without the
     * assumption of equal subpopulation variances.  Use
     * {@link #homoscedasticT(StatisticalSummary, StatisticalSummary)} to
     * compute a t-statistic under the equal variances assumption.
     * &lt;p&gt;
     * This statistic can be used to perform a two-sample t-test to compare
     * sample means.&lt;/p&gt;
     * &lt;p&gt;
      * The returned  t-statistic is&lt;/p&gt;
     * &lt;p&gt;
     * &amp;nbsp;&amp;nbsp; &lt;code&gt;  t = (m1 - m2) / sqrt(var1/n1 + var2/n2)&lt;/code&gt;
     * &lt;/p&gt;&lt;p&gt;
     * where &lt;strong&gt;&lt;code&gt;n1&lt;/code&gt;&lt;/strong&gt; is the size of the first sample;
     * &lt;strong&gt;&lt;code&gt; n2&lt;/code&gt;&lt;/strong&gt; is the size of the second sample;
     * &lt;strong&gt;&lt;code&gt; m1&lt;/code&gt;&lt;/strong&gt; is the mean of the first sample;
     * &lt;strong&gt;&lt;code&gt; m2&lt;/code&gt;&lt;/strong&gt; is the mean of the second sample
     * &lt;strong&gt;&lt;code&gt; var1&lt;/code&gt;&lt;/strong&gt; is the variance of the first sample;
     * &lt;strong&gt;&lt;code&gt; var2&lt;/code&gt;&lt;/strong&gt; is the variance of the second sample
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The datasets described by the two Univariates must each contain
     * at least 2 observations.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sampleStats1 StatisticalSummary describing data from the first sample
     * @param sampleStats2 StatisticalSummary describing data from the second sample
     * @return t statistic
     * @throws NullArgumentException if the sample statistics are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the number of samples is &amp;lt; 2
     */
    public double t(final StatisticalSummary sampleStats1,
                    final StatisticalSummary sampleStats2)
        throws NullArgumentException, NumberIsTooSmallException {

<span class="fc" id="L360">        checkSampleData(sampleStats1);</span>
<span class="fc" id="L361">        checkSampleData(sampleStats2);</span>
<span class="fc" id="L362">        return t(sampleStats1.getMean(), sampleStats2.getMean(),</span>
<span class="fc" id="L363">                 sampleStats1.getVariance(), sampleStats2.getVariance(),</span>
<span class="fc" id="L364">                 sampleStats1.getN(), sampleStats2.getN());</span>

    }

    /**
     * Computes a 2-sample t statistic, comparing the means of the datasets
     * described by two {@link StatisticalSummary} instances, under the
     * assumption of equal subpopulation variances.  To compute a t-statistic
     * without the equal variances assumption, use
     * {@link #t(StatisticalSummary, StatisticalSummary)}.
     * &lt;p&gt;
     * This statistic can be used to perform a (homoscedastic) two-sample
     * t-test to compare sample means.&lt;/p&gt;
     * &lt;p&gt;
     * The t-statistic returned is&lt;/p&gt;
     * &lt;p&gt;
     * &amp;nbsp;&amp;nbsp;&lt;code&gt;  t = (m1 - m2) / (sqrt(1/n1 +1/n2) sqrt(var))&lt;/code&gt;
     * &lt;/p&gt;&lt;p&gt;
     * where &lt;strong&gt;&lt;code&gt;n1&lt;/code&gt;&lt;/strong&gt; is the size of first sample;
     * &lt;strong&gt;&lt;code&gt; n2&lt;/code&gt;&lt;/strong&gt; is the size of second sample;
     * &lt;strong&gt;&lt;code&gt; m1&lt;/code&gt;&lt;/strong&gt; is the mean of first sample;
     * &lt;strong&gt;&lt;code&gt; m2&lt;/code&gt;&lt;/strong&gt; is the mean of second sample
     * and &lt;strong&gt;&lt;code&gt;var&lt;/code&gt;&lt;/strong&gt; is the pooled variance estimate:
     * &lt;/p&gt;&lt;p&gt;
     * &lt;code&gt;var = sqrt(((n1 - 1)var1 + (n2 - 1)var2) / ((n1-1) + (n2-1)))&lt;/code&gt;
     * &lt;/p&gt;&lt;p&gt;
     * with &lt;strong&gt;&lt;code&gt;var1&lt;/code&gt;&lt;/strong&gt; the variance of the first sample and
     * &lt;strong&gt;&lt;code&gt;var2&lt;/code&gt;&lt;/strong&gt; the variance of the second sample.
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The datasets described by the two Univariates must each contain
     * at least 2 observations.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sampleStats1 StatisticalSummary describing data from the first sample
     * @param sampleStats2 StatisticalSummary describing data from the second sample
     * @return t statistic
     * @throws NullArgumentException if the sample statistics are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the number of samples is &amp;lt; 2
     */
    public double homoscedasticT(final StatisticalSummary sampleStats1,
                                 final StatisticalSummary sampleStats2)
        throws NullArgumentException, NumberIsTooSmallException {

<span class="nc" id="L408">        checkSampleData(sampleStats1);</span>
<span class="nc" id="L409">        checkSampleData(sampleStats2);</span>
<span class="nc" id="L410">        return homoscedasticT(sampleStats1.getMean(), sampleStats2.getMean(),</span>
<span class="nc" id="L411">                              sampleStats1.getVariance(), sampleStats2.getVariance(),</span>
<span class="nc" id="L412">                              sampleStats1.getN(), sampleStats2.getN());</span>

    }

    /**
     * Returns the &lt;i&gt;observed significance level&lt;/i&gt;, or
     * &lt;i&gt;p-value&lt;/i&gt;, associated with a one-sample, two-tailed t-test
     * comparing the mean of the input array with the constant &lt;code&gt;mu&lt;/code&gt;.
     * &lt;p&gt;
     * The number returned is the smallest significance level
     * at which one can reject the null hypothesis that the mean equals
     * &lt;code&gt;mu&lt;/code&gt; in favor of the two-sided alternative that the mean
     * is different from &lt;code&gt;mu&lt;/code&gt;. For a one-sided test, divide the
     * returned value by 2.&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the test depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;here&lt;/a&gt;
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array length must be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param mu constant value to compare sample mean against
     * @param sample array of sample data values
     * @return p-value
     * @throws NullArgumentException if the sample array is &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of the array is &amp;lt; 2
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public double tTest(final double mu, final double[] sample)
        throws NullArgumentException, NumberIsTooSmallException,
        MaxCountExceededException {

<span class="fc" id="L447">        checkSampleData(sample);</span>
        // No try-catch or advertised exception because args have just been checked
<span class="fc" id="L449">        return tTest(StatUtils.mean(sample), mu, StatUtils.variance(sample),</span>
                     sample.length);

    }

    /**
     * Performs a &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/eda/section3/eda353.htm&quot;&gt;
     * two-sided t-test&lt;/a&gt; evaluating the null hypothesis that the mean of the population from
     * which &lt;code&gt;sample&lt;/code&gt; is drawn equals &lt;code&gt;mu&lt;/code&gt;.
     * &lt;p&gt;
     * Returns &lt;code&gt;true&lt;/code&gt; iff the null hypothesis can be
     * rejected with confidence &lt;code&gt;1 - alpha&lt;/code&gt;.  To
     * perform a 1-sided test, use &lt;code&gt;alpha * 2&lt;/code&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Examples:&lt;/strong&gt;&lt;br&gt;&lt;ol&gt;
     * &lt;li&gt;To test the (2-sided) hypothesis &lt;code&gt;sample mean = mu &lt;/code&gt; at
     * the 95% level, use &lt;br&gt;&lt;code&gt;tTest(mu, sample, 0.05) &lt;/code&gt;
     * &lt;/li&gt;
     * &lt;li&gt;To test the (one-sided) hypothesis &lt;code&gt; sample mean &amp;lt; mu &lt;/code&gt;
     * at the 99% level, first verify that the measured sample mean is less
     * than &lt;code&gt;mu&lt;/code&gt; and then use
     * &lt;br&gt;&lt;code&gt;tTest(mu, sample, 0.02) &lt;/code&gt;
     * &lt;/li&gt;&lt;/ol&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the test depends on the assumptions of the one-sample
     * parametric t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/sg_glos.html#one-sample&quot;&gt;here&lt;/a&gt;
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array length must be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param mu constant value to compare sample mean against
     * @param sample array of sample data values
     * @param alpha significance level of the test
     * @return p-value
     * @throws NullArgumentException if the sample array is &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of the array is &amp;lt; 2
     * @throws OutOfRangeException if &lt;code&gt;alpha&lt;/code&gt; is not in the range (0, 0.5]
     * @throws MaxCountExceededException if an error computing the p-value
     */
    public boolean tTest(final double mu, final double[] sample, final double alpha)
        throws NullArgumentException, NumberIsTooSmallException,
        OutOfRangeException, MaxCountExceededException {

<span class="fc" id="L495">        checkSignificanceLevel(alpha);</span>
<span class="fc bfc" id="L496" title="All 2 branches covered.">        return tTest(mu, sample) &lt; alpha;</span>

    }

    /**
     * Returns the &lt;i&gt;observed significance level&lt;/i&gt;, or
     * &lt;i&gt;p-value&lt;/i&gt;, associated with a one-sample, two-tailed t-test
     * comparing the mean of the dataset described by &lt;code&gt;sampleStats&lt;/code&gt;
     * with the constant &lt;code&gt;mu&lt;/code&gt;.
     * &lt;p&gt;
     * The number returned is the smallest significance level
     * at which one can reject the null hypothesis that the mean equals
     * &lt;code&gt;mu&lt;/code&gt; in favor of the two-sided alternative that the mean
     * is different from &lt;code&gt;mu&lt;/code&gt;. For a one-sided test, divide the
     * returned value by 2.&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the test depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The sample must contain at least 2 observations.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param mu constant value to compare sample mean against
     * @param sampleStats StatisticalSummary describing sample data
     * @return p-value
     * @throws NullArgumentException if &lt;code&gt;sampleStats&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the number of samples is &amp;lt; 2
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public double tTest(final double mu, final StatisticalSummary sampleStats)
        throws NullArgumentException, NumberIsTooSmallException,
        MaxCountExceededException {

<span class="fc" id="L533">        checkSampleData(sampleStats);</span>
<span class="fc" id="L534">        return tTest(sampleStats.getMean(), mu, sampleStats.getVariance(),</span>
<span class="fc" id="L535">                     sampleStats.getN());</span>

    }

    /**
     * Performs a &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/eda/section3/eda353.htm&quot;&gt;
     * two-sided t-test&lt;/a&gt; evaluating the null hypothesis that the mean of the
     * population from which the dataset described by &lt;code&gt;stats&lt;/code&gt; is
     * drawn equals &lt;code&gt;mu&lt;/code&gt;.
     * &lt;p&gt;
     * Returns &lt;code&gt;true&lt;/code&gt; iff the null hypothesis can be rejected with
     * confidence &lt;code&gt;1 - alpha&lt;/code&gt;.  To  perform a 1-sided test, use
     * &lt;code&gt;alpha * 2.&lt;/code&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Examples:&lt;/strong&gt;&lt;br&gt;&lt;ol&gt;
     * &lt;li&gt;To test the (2-sided) hypothesis &lt;code&gt;sample mean = mu &lt;/code&gt; at
     * the 95% level, use &lt;br&gt;&lt;code&gt;tTest(mu, sampleStats, 0.05) &lt;/code&gt;
     * &lt;/li&gt;
     * &lt;li&gt;To test the (one-sided) hypothesis &lt;code&gt; sample mean &amp;lt; mu &lt;/code&gt;
     * at the 99% level, first verify that the measured sample mean is less
     * than &lt;code&gt;mu&lt;/code&gt; and then use
     * &lt;br&gt;&lt;code&gt;tTest(mu, sampleStats, 0.02) &lt;/code&gt;
     * &lt;/li&gt;&lt;/ol&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the test depends on the assumptions of the one-sample
     * parametric t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/sg_glos.html#one-sample&quot;&gt;here&lt;/a&gt;
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The sample must include at least 2 observations.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param mu constant value to compare sample mean against
     * @param sampleStats StatisticalSummary describing sample data values
     * @param alpha significance level of the test
     * @return p-value
     * @throws NullArgumentException if &lt;code&gt;sampleStats&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the number of samples is &amp;lt; 2
     * @throws OutOfRangeException if &lt;code&gt;alpha&lt;/code&gt; is not in the range (0, 0.5]
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public boolean tTest(final double mu, final StatisticalSummary sampleStats,
                         final double alpha)
    throws NullArgumentException, NumberIsTooSmallException,
    OutOfRangeException, MaxCountExceededException {

<span class="fc" id="L582">        checkSignificanceLevel(alpha);</span>
<span class="fc bfc" id="L583" title="All 2 branches covered.">        return tTest(mu, sampleStats) &lt; alpha;</span>

    }

    /**
     * Returns the &lt;i&gt;observed significance level&lt;/i&gt;, or
     * &lt;i&gt;p-value&lt;/i&gt;, associated with a two-sample, two-tailed t-test
     * comparing the means of the input arrays.
     * &lt;p&gt;
     * The number returned is the smallest significance level
     * at which one can reject the null hypothesis that the two means are
     * equal in favor of the two-sided alternative that they are different.
     * For a one-sided test, divide the returned value by 2.&lt;/p&gt;
     * &lt;p&gt;
     * The test does not assume that the underlying popuation variances are
     * equal  and it uses approximated degrees of freedom computed from the
     * sample data to compute the p-value.  The t-statistic used is as defined in
     * {@link #t(double[], double[])} and the Welch-Satterthwaite approximation
     * to the degrees of freedom is used,
     * as described
     * &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/prc/section3/prc31.htm&quot;&gt;
     * here.&lt;/a&gt;  To perform the test under the assumption of equal subpopulation
     * variances, use {@link #homoscedasticTTest(double[], double[])}.&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the p-value depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array lengths must both be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @return p-value for t-test
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public double tTest(final double[] sample1, final double[] sample2)
        throws NullArgumentException, NumberIsTooSmallException,
        MaxCountExceededException {

<span class="fc" id="L628">        checkSampleData(sample1);</span>
<span class="fc" id="L629">        checkSampleData(sample2);</span>
        // No try-catch or advertised exception because args have just been checked
<span class="fc" id="L631">        return tTest(StatUtils.mean(sample1), StatUtils.mean(sample2),</span>
<span class="fc" id="L632">                     StatUtils.variance(sample1), StatUtils.variance(sample2),</span>
                     sample1.length, sample2.length);

    }

    /**
     * Returns the &lt;i&gt;observed significance level&lt;/i&gt;, or
     * &lt;i&gt;p-value&lt;/i&gt;, associated with a two-sample, two-tailed t-test
     * comparing the means of the input arrays, under the assumption that
     * the two samples are drawn from subpopulations with equal variances.
     * To perform the test without the equal variances assumption, use
     * {@link #tTest(double[], double[])}.
     * &lt;p&gt;
     * The number returned is the smallest significance level
     * at which one can reject the null hypothesis that the two means are
     * equal in favor of the two-sided alternative that they are different.
     * For a one-sided test, divide the returned value by 2.&lt;/p&gt;
     * &lt;p&gt;
     * A pooled variance estimate is used to compute the t-statistic.  See
     * {@link #homoscedasticT(double[], double[])}. The sum of the sample sizes
     * minus 2 is used as the degrees of freedom.&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the p-value depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array lengths must both be at least 2.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @return p-value for t-test
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public double homoscedasticTTest(final double[] sample1, final double[] sample2)
        throws NullArgumentException, NumberIsTooSmallException,
        MaxCountExceededException {

<span class="fc" id="L675">        checkSampleData(sample1);</span>
<span class="fc" id="L676">        checkSampleData(sample2);</span>
        // No try-catch or advertised exception because args have just been checked
<span class="fc" id="L678">        return homoscedasticTTest(StatUtils.mean(sample1),</span>
<span class="fc" id="L679">                                  StatUtils.mean(sample2),</span>
<span class="fc" id="L680">                                  StatUtils.variance(sample1),</span>
<span class="fc" id="L681">                                  StatUtils.variance(sample2),</span>
                                  sample1.length, sample2.length);

    }

    /**
     * Performs a
     * &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/eda/section3/eda353.htm&quot;&gt;
     * two-sided t-test&lt;/a&gt; evaluating the null hypothesis that &lt;code&gt;sample1&lt;/code&gt;
     * and &lt;code&gt;sample2&lt;/code&gt; are drawn from populations with the same mean,
     * with significance level &lt;code&gt;alpha&lt;/code&gt;.  This test does not assume
     * that the subpopulation variances are equal.  To perform the test assuming
     * equal variances, use
     * {@link #homoscedasticTTest(double[], double[], double)}.
     * &lt;p&gt;
     * Returns &lt;code&gt;true&lt;/code&gt; iff the null hypothesis that the means are
     * equal can be rejected with confidence &lt;code&gt;1 - alpha&lt;/code&gt;.  To
     * perform a 1-sided test, use &lt;code&gt;alpha * 2&lt;/code&gt;&lt;/p&gt;
     * &lt;p&gt;
     * See {@link #t(double[], double[])} for the formula used to compute the
     * t-statistic.  Degrees of freedom are approximated using the
     * &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/prc/section3/prc31.htm&quot;&gt;
     * Welch-Satterthwaite approximation.&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Examples:&lt;/strong&gt;&lt;br&gt;&lt;ol&gt;
     * &lt;li&gt;To test the (2-sided) hypothesis &lt;code&gt;mean 1 = mean 2 &lt;/code&gt; at
     * the 95% level,  use
     * &lt;br&gt;&lt;code&gt;tTest(sample1, sample2, 0.05). &lt;/code&gt;
     * &lt;/li&gt;
     * &lt;li&gt;To test the (one-sided) hypothesis &lt;code&gt; mean 1 &amp;lt; mean 2 &lt;/code&gt;,
     * at the 99% level, first verify that the measured  mean of &lt;code&gt;sample 1&lt;/code&gt;
     * is less than the mean of &lt;code&gt;sample 2&lt;/code&gt; and then use
     * &lt;br&gt;&lt;code&gt;tTest(sample1, sample2, 0.02) &lt;/code&gt;
     * &lt;/li&gt;&lt;/ol&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the test depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array lengths must both be at least 2.
     * &lt;/li&gt;
     * &lt;li&gt; &lt;code&gt; 0 &amp;lt; alpha &amp;lt; 0.5 &lt;/code&gt;
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @param alpha significance level of the test
     * @return true if the null hypothesis can be rejected with
     * confidence 1 - alpha
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     * @throws OutOfRangeException if &lt;code&gt;alpha&lt;/code&gt; is not in the range (0, 0.5]
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public boolean tTest(final double[] sample1, final double[] sample2,
                         final double alpha)
        throws NullArgumentException, NumberIsTooSmallException,
        OutOfRangeException, MaxCountExceededException {

<span class="fc" id="L743">        checkSignificanceLevel(alpha);</span>
<span class="fc bfc" id="L744" title="All 2 branches covered.">        return tTest(sample1, sample2) &lt; alpha;</span>

    }

    /**
     * Performs a
     * &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/eda/section3/eda353.htm&quot;&gt;
     * two-sided t-test&lt;/a&gt; evaluating the null hypothesis that &lt;code&gt;sample1&lt;/code&gt;
     * and &lt;code&gt;sample2&lt;/code&gt; are drawn from populations with the same mean,
     * with significance level &lt;code&gt;alpha&lt;/code&gt;,  assuming that the
     * subpopulation variances are equal.  Use
     * {@link #tTest(double[], double[], double)} to perform the test without
     * the assumption of equal variances.
     * &lt;p&gt;
     * Returns &lt;code&gt;true&lt;/code&gt; iff the null hypothesis that the means are
     * equal can be rejected with confidence &lt;code&gt;1 - alpha&lt;/code&gt;.  To
     * perform a 1-sided test, use &lt;code&gt;alpha * 2.&lt;/code&gt;  To perform the test
     * without the assumption of equal subpopulation variances, use
     * {@link #tTest(double[], double[], double)}.&lt;/p&gt;
     * &lt;p&gt;
     * A pooled variance estimate is used to compute the t-statistic. See
     * {@link #t(double[], double[])} for the formula. The sum of the sample
     * sizes minus 2 is used as the degrees of freedom.&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Examples:&lt;/strong&gt;&lt;br&gt;&lt;ol&gt;
     * &lt;li&gt;To test the (2-sided) hypothesis &lt;code&gt;mean 1 = mean 2 &lt;/code&gt; at
     * the 95% level, use &lt;br&gt;&lt;code&gt;tTest(sample1, sample2, 0.05). &lt;/code&gt;
     * &lt;/li&gt;
     * &lt;li&gt;To test the (one-sided) hypothesis &lt;code&gt; mean 1 &amp;lt; mean 2, &lt;/code&gt;
     * at the 99% level, first verify that the measured mean of
     * &lt;code&gt;sample 1&lt;/code&gt; is less than the mean of &lt;code&gt;sample 2&lt;/code&gt;
     * and then use
     * &lt;br&gt;&lt;code&gt;tTest(sample1, sample2, 0.02) &lt;/code&gt;
     * &lt;/li&gt;&lt;/ol&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the test depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The observed array lengths must both be at least 2.
     * &lt;/li&gt;
     * &lt;li&gt; &lt;code&gt; 0 &amp;lt; alpha &amp;lt; 0.5 &lt;/code&gt;
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sample1 array of sample data values
     * @param sample2 array of sample data values
     * @param alpha significance level of the test
     * @return true if the null hypothesis can be rejected with
     * confidence 1 - alpha
     * @throws NullArgumentException if the arrays are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the length of the arrays is &amp;lt; 2
     * @throws OutOfRangeException if &lt;code&gt;alpha&lt;/code&gt; is not in the range (0, 0.5]
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public boolean homoscedasticTTest(final double[] sample1, final double[] sample2,
                                      final double alpha)
        throws NullArgumentException, NumberIsTooSmallException,
        OutOfRangeException, MaxCountExceededException {

<span class="fc" id="L806">        checkSignificanceLevel(alpha);</span>
<span class="fc bfc" id="L807" title="All 2 branches covered.">        return homoscedasticTTest(sample1, sample2) &lt; alpha;</span>

    }

    /**
     * Returns the &lt;i&gt;observed significance level&lt;/i&gt;, or
     * &lt;i&gt;p-value&lt;/i&gt;, associated with a two-sample, two-tailed t-test
     * comparing the means of the datasets described by two StatisticalSummary
     * instances.
     * &lt;p&gt;
     * The number returned is the smallest significance level
     * at which one can reject the null hypothesis that the two means are
     * equal in favor of the two-sided alternative that they are different.
     * For a one-sided test, divide the returned value by 2.&lt;/p&gt;
     * &lt;p&gt;
     * The test does not assume that the underlying population variances are
     * equal  and it uses approximated degrees of freedom computed from the
     * sample data to compute the p-value.   To perform the test assuming
     * equal variances, use
     * {@link #homoscedasticTTest(StatisticalSummary, StatisticalSummary)}.&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the p-value depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The datasets described by the two Univariates must each contain
     * at least 2 observations.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sampleStats1  StatisticalSummary describing data from the first sample
     * @param sampleStats2  StatisticalSummary describing data from the second sample
     * @return p-value for t-test
     * @throws NullArgumentException if the sample statistics are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the number of samples is &amp;lt; 2
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public double tTest(final StatisticalSummary sampleStats1,
                        final StatisticalSummary sampleStats2)
        throws NullArgumentException, NumberIsTooSmallException,
        MaxCountExceededException {

<span class="fc" id="L851">        checkSampleData(sampleStats1);</span>
<span class="fc" id="L852">        checkSampleData(sampleStats2);</span>
<span class="fc" id="L853">        return tTest(sampleStats1.getMean(), sampleStats2.getMean(),</span>
<span class="fc" id="L854">                     sampleStats1.getVariance(), sampleStats2.getVariance(),</span>
<span class="fc" id="L855">                     sampleStats1.getN(), sampleStats2.getN());</span>

    }

    /**
     * Returns the &lt;i&gt;observed significance level&lt;/i&gt;, or
     * &lt;i&gt;p-value&lt;/i&gt;, associated with a two-sample, two-tailed t-test
     * comparing the means of the datasets described by two StatisticalSummary
     * instances, under the hypothesis of equal subpopulation variances. To
     * perform a test without the equal variances assumption, use
     * {@link #tTest(StatisticalSummary, StatisticalSummary)}.
     * &lt;p&gt;
     * The number returned is the smallest significance level
     * at which one can reject the null hypothesis that the two means are
     * equal in favor of the two-sided alternative that they are different.
     * For a one-sided test, divide the returned value by 2.&lt;/p&gt;
     * &lt;p&gt;
     * See {@link #homoscedasticT(double[], double[])} for the formula used to
     * compute the t-statistic. The sum of the  sample sizes minus 2 is used as
     * the degrees of freedom.&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the p-value depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;here&lt;/a&gt;
     * &lt;/p&gt;&lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The datasets described by the two Univariates must each contain
     * at least 2 observations.
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sampleStats1  StatisticalSummary describing data from the first sample
     * @param sampleStats2  StatisticalSummary describing data from the second sample
     * @return p-value for t-test
     * @throws NullArgumentException if the sample statistics are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the number of samples is &amp;lt; 2
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public double homoscedasticTTest(final StatisticalSummary sampleStats1,
                                     final StatisticalSummary sampleStats2)
        throws NullArgumentException, NumberIsTooSmallException,
        MaxCountExceededException {

<span class="fc" id="L898">        checkSampleData(sampleStats1);</span>
<span class="fc" id="L899">        checkSampleData(sampleStats2);</span>
<span class="fc" id="L900">        return homoscedasticTTest(sampleStats1.getMean(),</span>
<span class="fc" id="L901">                                  sampleStats2.getMean(),</span>
<span class="fc" id="L902">                                  sampleStats1.getVariance(),</span>
<span class="fc" id="L903">                                  sampleStats2.getVariance(),</span>
<span class="fc" id="L904">                                  sampleStats1.getN(), sampleStats2.getN());</span>

    }

    /**
     * Performs a
     * &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/eda/section3/eda353.htm&quot;&gt;
     * two-sided t-test&lt;/a&gt; evaluating the null hypothesis that
     * &lt;code&gt;sampleStats1&lt;/code&gt; and &lt;code&gt;sampleStats2&lt;/code&gt; describe
     * datasets drawn from populations with the same mean, with significance
     * level &lt;code&gt;alpha&lt;/code&gt;.   This test does not assume that the
     * subpopulation variances are equal.  To perform the test under the equal
     * variances assumption, use
     * {@link #homoscedasticTTest(StatisticalSummary, StatisticalSummary)}.
     * &lt;p&gt;
     * Returns &lt;code&gt;true&lt;/code&gt; iff the null hypothesis that the means are
     * equal can be rejected with confidence &lt;code&gt;1 - alpha&lt;/code&gt;.  To
     * perform a 1-sided test, use &lt;code&gt;alpha * 2&lt;/code&gt;&lt;/p&gt;
     * &lt;p&gt;
     * See {@link #t(double[], double[])} for the formula used to compute the
     * t-statistic.  Degrees of freedom are approximated using the
     * &lt;a href=&quot;http://www.itl.nist.gov/div898/handbook/prc/section3/prc31.htm&quot;&gt;
     * Welch-Satterthwaite approximation.&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Examples:&lt;/strong&gt;&lt;br&gt;&lt;ol&gt;
     * &lt;li&gt;To test the (2-sided) hypothesis &lt;code&gt;mean 1 = mean 2 &lt;/code&gt; at
     * the 95%, use
     * &lt;br&gt;&lt;code&gt;tTest(sampleStats1, sampleStats2, 0.05) &lt;/code&gt;
     * &lt;/li&gt;
     * &lt;li&gt;To test the (one-sided) hypothesis &lt;code&gt; mean 1 &amp;lt; mean 2 &lt;/code&gt;
     * at the 99% level,  first verify that the measured mean of
     * &lt;code&gt;sample 1&lt;/code&gt; is less than  the mean of &lt;code&gt;sample 2&lt;/code&gt;
     * and then use
     * &lt;br&gt;&lt;code&gt;tTest(sampleStats1, sampleStats2, 0.02) &lt;/code&gt;
     * &lt;/li&gt;&lt;/ol&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Usage Note:&lt;/strong&gt;&lt;br&gt;
     * The validity of the test depends on the assumptions of the parametric
     * t-test procedure, as discussed
     * &lt;a href=&quot;http://www.basic.nwu.edu/statguidefiles/ttest_unpaired_ass_viol.html&quot;&gt;
     * here&lt;/a&gt;&lt;/p&gt;
     * &lt;p&gt;
     * &lt;strong&gt;Preconditions&lt;/strong&gt;: &lt;ul&gt;
     * &lt;li&gt;The datasets described by the two Univariates must each contain
     * at least 2 observations.
     * &lt;/li&gt;
     * &lt;li&gt; &lt;code&gt; 0 &amp;lt; alpha &amp;lt; 0.5 &lt;/code&gt;
     * &lt;/li&gt;&lt;/ul&gt;
     *
     * @param sampleStats1 StatisticalSummary describing sample data values
     * @param sampleStats2 StatisticalSummary describing sample data values
     * @param alpha significance level of the test
     * @return true if the null hypothesis can be rejected with
     * confidence 1 - alpha
     * @throws NullArgumentException if the sample statistics are &lt;code&gt;null&lt;/code&gt;
     * @throws NumberIsTooSmallException if the number of samples is &amp;lt; 2
     * @throws OutOfRangeException if &lt;code&gt;alpha&lt;/code&gt; is not in the range (0, 0.5]
     * @throws MaxCountExceededException if an error occurs computing the p-value
     */
    public boolean tTest(final StatisticalSummary sampleStats1,
                         final StatisticalSummary sampleStats2,
                         final double alpha)
        throws NullArgumentException, NumberIsTooSmallException,
        OutOfRangeException, MaxCountExceededException {

<span class="fc" id="L969">        checkSignificanceLevel(alpha);</span>
<span class="fc bfc" id="L970" title="All 2 branches covered.">        return tTest(sampleStats1, sampleStats2) &lt; alpha;</span>

    }

    //----------------------------------------------- Protected methods

    /**
     * Computes approximate degrees of freedom for 2-sample t-test.
     *
     * @param v1 first sample variance
     * @param v2 second sample variance
     * @param n1 first sample n
     * @param n2 second sample n
     * @return approximate degrees of freedom
     */
    protected double df(double v1, double v2, double n1, double n2) {
<span class="fc" id="L986">        return (((v1 / n1) + (v2 / n2)) * ((v1 / n1) + (v2 / n2))) /</span>
        ((v1 * v1) / (n1 * n1 * (n1 - 1d)) + (v2 * v2) /
                (n2 * n2 * (n2 - 1d)));
    }

    /**
     * Computes t test statistic for 1-sample t-test.
     *
     * @param m sample mean
     * @param mu constant to test against
     * @param v sample variance
     * @param n sample n
     * @return t test statistic
     */
    protected double t(final double m, final double mu,
                       final double v, final double n) {
<span class="fc" id="L1002">        return (m - mu) / FastMath.sqrt(v / n);</span>
    }

    /**
     * Computes t test statistic for 2-sample t-test.
     * &lt;p&gt;
     * Does not assume that subpopulation variances are equal.&lt;/p&gt;
     *
     * @param m1 first sample mean
     * @param m2 second sample mean
     * @param v1 first sample variance
     * @param v2 second sample variance
     * @param n1 first sample n
     * @param n2 second sample n
     * @return t test statistic
     */
    protected double t(final double m1, final double m2,
                       final double v1, final double v2,
                       final double n1, final double n2)  {
<span class="fc" id="L1021">        return (m1 - m2) / FastMath.sqrt((v1 / n1) + (v2 / n2));</span>
    }

    /**
     * Computes t test statistic for 2-sample t-test under the hypothesis
     * of equal subpopulation variances.
     *
     * @param m1 first sample mean
     * @param m2 second sample mean
     * @param v1 first sample variance
     * @param v2 second sample variance
     * @param n1 first sample n
     * @param n2 second sample n
     * @return t test statistic
     */
    protected double homoscedasticT(final double m1, final double m2,
                                    final double v1, final double v2,
                                    final double n1, final double n2)  {
<span class="fc" id="L1039">        final double pooledVariance = ((n1  - 1) * v1 + (n2 -1) * v2 ) / (n1 + n2 - 2);</span>
<span class="fc" id="L1040">        return (m1 - m2) / FastMath.sqrt(pooledVariance * (1d / n1 + 1d / n2));</span>
    }

    /**
     * Computes p-value for 2-sided, 1-sample t-test.
     *
     * @param m sample mean
     * @param mu constant to test against
     * @param v sample variance
     * @param n sample n
     * @return p-value
     * @throws MaxCountExceededException if an error occurs computing the p-value
     * @throws MathIllegalArgumentException if n is not greater than 1
     */
    protected double tTest(final double m, final double mu,
                           final double v, final double n)
        throws MaxCountExceededException, MathIllegalArgumentException {

<span class="fc" id="L1058">        final double t = FastMath.abs(t(m, mu, v, n));</span>
        // pass a null rng to avoid unneeded overhead as we will not sample from this distribution
<span class="fc" id="L1060">        final TDistribution distribution = new TDistribution(n - 1);</span>
<span class="fc" id="L1061">        return 2.0 * distribution.cumulativeProbability(-t);</span>

    }

    /**
     * Computes p-value for 2-sided, 2-sample t-test.
     * &lt;p&gt;
     * Does not assume subpopulation variances are equal. Degrees of freedom
     * are estimated from the data.&lt;/p&gt;
     *
     * @param m1 first sample mean
     * @param m2 second sample mean
     * @param v1 first sample variance
     * @param v2 second sample variance
     * @param n1 first sample n
     * @param n2 second sample n
     * @return p-value
     * @throws MaxCountExceededException if an error occurs computing the p-value
     * @throws NotStrictlyPositiveException if the estimated degrees of freedom is not
     * strictly positive
     */
    protected double tTest(final double m1, final double m2,
                           final double v1, final double v2,
                           final double n1, final double n2)
        throws MaxCountExceededException, NotStrictlyPositiveException {

<span class="fc" id="L1087">        final double t = FastMath.abs(t(m1, m2, v1, v2, n1, n2));</span>
<span class="fc" id="L1088">        final double degreesOfFreedom = df(v1, v2, n1, n2);</span>
        // pass a null rng to avoid unneeded overhead as we will not sample from this distribution
<span class="fc" id="L1090">        final TDistribution distribution = new TDistribution(degreesOfFreedom);</span>
<span class="fc" id="L1091">        return 2.0 * distribution.cumulativeProbability(-t);</span>

    }

    /**
     * Computes p-value for 2-sided, 2-sample t-test, under the assumption
     * of equal subpopulation variances.
     * &lt;p&gt;
     * The sum of the sample sizes minus 2 is used as degrees of freedom.&lt;/p&gt;
     *
     * @param m1 first sample mean
     * @param m2 second sample mean
     * @param v1 first sample variance
     * @param v2 second sample variance
     * @param n1 first sample n
     * @param n2 second sample n
     * @return p-value
     * @throws MaxCountExceededException if an error occurs computing the p-value
     * @throws NotStrictlyPositiveException if the estimated degrees of freedom is not
     * strictly positive
     */
    protected double homoscedasticTTest(double m1, double m2,
                                        double v1, double v2,
                                        double n1, double n2)
        throws MaxCountExceededException, NotStrictlyPositiveException {

<span class="fc" id="L1117">        final double t = FastMath.abs(homoscedasticT(m1, m2, v1, v2, n1, n2));</span>
<span class="fc" id="L1118">        final double degreesOfFreedom = n1 + n2 - 2;</span>
        // pass a null rng to avoid unneeded overhead as we will not sample from this distribution
<span class="fc" id="L1120">        final TDistribution distribution = new TDistribution(degreesOfFreedom);</span>
<span class="fc" id="L1121">        return 2.0 * distribution.cumulativeProbability(-t);</span>

    }

    /**
     * Check significance level.
     *
     * @param alpha significance level
     * @throws OutOfRangeException if the significance level is out of bounds.
     */
    private void checkSignificanceLevel(final double alpha)
        throws OutOfRangeException {

<span class="pc bpc" id="L1134" title="1 of 4 branches missed.">        if (alpha &lt;= 0 || alpha &gt; 0.5) {</span>
<span class="fc" id="L1135">            throw new OutOfRangeException(LocalizedFormats.SIGNIFICANCE_LEVEL,</span>
<span class="fc" id="L1136">                                          alpha, 0.0, 0.5);</span>
        }

<span class="fc" id="L1139">    }</span>

    /**
     * Check sample data.
     *
     * @param data Sample data.
     * @throws NullArgumentException if {@code data} is {@code null}.
     * @throws NumberIsTooSmallException if there is not enough sample data.
     */
    private void checkSampleData(final double[] data)
        throws NullArgumentException, NumberIsTooSmallException {

<span class="fc bfc" id="L1151" title="All 2 branches covered.">        if (data == null) {</span>
<span class="fc" id="L1152">            throw new NullArgumentException();</span>
        }
<span class="fc bfc" id="L1154" title="All 2 branches covered.">        if (data.length &lt; 2) {</span>
<span class="fc" id="L1155">            throw new NumberIsTooSmallException(</span>
                    LocalizedFormats.INSUFFICIENT_DATA_FOR_T_STATISTIC,
<span class="fc" id="L1157">                    data.length, 2, true);</span>
        }

<span class="fc" id="L1160">    }</span>

    /**
     * Check sample data.
     *
     * @param stat Statistical summary.
     * @throws NullArgumentException if {@code data} is {@code null}.
     * @throws NumberIsTooSmallException if there is not enough sample data.
     */
    private void checkSampleData(final StatisticalSummary stat)
        throws NullArgumentException, NumberIsTooSmallException {

<span class="fc bfc" id="L1172" title="All 2 branches covered.">        if (stat == null) {</span>
<span class="fc" id="L1173">            throw new NullArgumentException();</span>
        }
<span class="fc bfc" id="L1175" title="All 2 branches covered.">        if (stat.getN() &lt; 2) {</span>
<span class="fc" id="L1176">            throw new NumberIsTooSmallException(</span>
                    LocalizedFormats.INSUFFICIENT_DATA_FOR_T_STATISTIC,
<span class="fc" id="L1178">                    stat.getN(), 2, true);</span>
        }

<span class="fc" id="L1181">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>